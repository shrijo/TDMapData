<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESRI Synchronized Maps - Satellite & DEM</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    body {
        overflow: hidden;
    }
    
    .container {
        display: flex;
        height: 100vh;
        width: 100vw;
    }
    
    .map-container {
        flex: 1;
        position: relative;
    }
    
    .map {
        width: 100%;
        height: 100%;
    }
    
    .divider {
        width: 2px;
        background: #333;
        cursor: col-resize;
    }
    
    /* Hide Leaflet attribution for cleaner look */
    .leaflet-control-attribution {
        display: none;
    }
    
    /* Remove all zoom controls for minimal UI */
    .leaflet-control-zoom {
        display: none;
    }
</style>
```

</head>
<body>
    <div class="container">
        <div class="map-container">
            <div id="satelliteMap" class="map"></div>
        </div>

```
    <div class="divider"></div>
    
    <div class="map-container">
        <div id="demMap" class="map"></div>
    </div>
</div>

<script>
    // Initialize both maps at Grand Canyon for good elevation visibility
    const initialCenter = [36.0884, -112.0985];
    const initialZoom = 11;

    const satelliteMap = L.map('satelliteMap', {
        center: initialCenter,
        zoom: initialZoom,
        zoomControl: false,
        attributionControl: false
    });

    const demMap = L.map('demMap', {
        center: initialCenter,
        zoom: initialZoom,
        zoomControl: false,
        attributionControl: false
    });

    // ESRI World Imagery - Satellite basemap
    L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
        maxZoom: 19,
        maxNativeZoom: 19
    }).addTo(satelliteMap);

    // ESRI Terrain (Elevation) Base - This provides actual elevation data encoded in colors
    // Using ESRI's Terrain basemap which includes elevation-coded colors
    L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}', {
        maxZoom: 13,
        maxNativeZoom: 13
    }).addTo(demMap);

    // Alternative: Use USGS National Map Elevation services for true DEM heightmap
    // This provides actual height values encoded in the imagery
    L.tileLayer('https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/tile/{z}/{y}/{x}', {
        maxZoom: 16,
        opacity: 0
    }).addTo(demMap);

    // Add NASA SRTM colored elevation (true heightmap with color-coded elevations)
    // Each color represents a specific elevation range
    L.tileLayer('https://tiles.arcgis.com/tiles/C8EMgrsFcRFL6LrL/arcgis/rest/services/ETOPO1_Global_Relief_Model_Color_Shaded_Relief/MapServer/tile/{z}/{y}/{x}', {
        maxZoom: 10,
        maxNativeZoom: 10,
        opacity: 0.9
    }).addTo(demMap);

    // Alternative DEM source - Mapbox Terrain RGB (encodes elevation in RGB values)
    // Uncomment to use - requires decoding RGB to elevation: height = -10000 + ((R * 256 * 256 + G * 256 + B) * 0.1)
    /*
    L.tileLayer('https://api.mapbox.com/v4/mapbox.terrain-rgb/{z}/{x}/{y}.pngraw?access_token=YOUR_MAPBOX_TOKEN', {
        maxZoom: 15,
        tileSize: 256
    }).addTo(demMap);
    */

    // ESRI World Elevation 3D service - provides elevation as a service
    // This is a true DEM where pixel values represent actual elevation
    L.tileLayer('https://elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer/tile/{z}/{y}/{x}', {
        maxZoom: 15,
        maxNativeZoom: 15,
        opacity: 1
    }).addTo(demMap);

    // Sync state
    let programmaticMove = false;

    // Sync function
    function syncMaps(sourceMap, targetMap) {
        if (programmaticMove) return;
        
        programmaticMove = true;
        targetMap.setView(sourceMap.getCenter(), sourceMap.getZoom(), {
            animate: false
        });
        programmaticMove = false;
    }

    // Add event listeners for synchronization
    satelliteMap.on('move', () => syncMaps(satelliteMap, demMap));
    satelliteMap.on('zoom', () => syncMaps(satelliteMap, demMap));
    demMap.on('move', () => syncMaps(demMap, satelliteMap));
    demMap.on('zoom', () => syncMaps(demMap, satelliteMap));

    // Make divider draggable for resizing
    const divider = document.querySelector('.divider');
    const container = document.querySelector('.container');
    const leftPanel = container.children[0];
    const rightPanel = container.children[2];
    
    let isResizing = false;
    
    divider.addEventListener('mousedown', (e) => {
        isResizing = true;
        document.body.style.cursor = 'col-resize';
        e.preventDefault();
    });
    
    document.addEventListener('mousemove', (e) => {
        if (!isResizing) return;
        
        const containerRect = container.getBoundingClientRect();
        const percentage = ((e.clientX - containerRect.left) / containerRect.width) * 100;
        
        if (percentage > 10 && percentage < 90) {
            leftPanel.style.flex = `0 0 ${percentage}%`;
            rightPanel.style.flex = `0 0 ${100 - percentage}%`;
            
            // Invalidate map sizes after resize
            setTimeout(() => {
                satelliteMap.invalidateSize();
                demMap.invalidateSize();
            }, 10);
        }
    });
    
    document.addEventListener('mouseup', () => {
        isResizing = false;
        document.body.style.cursor = 'default';
    });

    // Handle window resize
    window.addEventListener('resize', () => {
        satelliteMap.invalidateSize();
        demMap.invalidateSize();
    });

    // Enable scroll wheel zoom
    satelliteMap.scrollWheelZoom.enable();
    demMap.scrollWheelZoom.enable();

    // Optional: Click handler to get elevation data at a point
    // This would require additional API calls to ESRI's elevation service
    demMap.on('click', function(e) {
        // Example elevation query endpoint (requires additional implementation):
        // https://elevation.arcgis.com/arcgis/rest/services/WorldElevation/Terrain/ImageServer/identify
        console.log('Clicked at:', e.latlng);
        // In a full implementation, you would query the elevation service here
    });
</script>
```

</body>
</html>