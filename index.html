<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TouchDesigner Map Viewer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    body {
        height: 100vh;
        width: 100vw;
        overflow: hidden;
        background: #000;
    }
    
    .split-container {
        display: flex;
        height: 100vh;
        width: 100vw;
    }
    
    .left-panel, .right-panel {
        flex: 1;
        height: 100vh;
        position: relative;
    }
    
    .map-view {
        width: 100%;
        height: 100%;
        cursor: grab;
    }
    
    .map-view:active {
        cursor: grabbing;
    }
</style>
```

</head>
<body>
    <div class="split-container">
        <div class="left-panel">
            <div id="satellite-view" class="map-view"></div>
        </div>
        <div class="right-panel">
            <div id="elevation-view" class="map-view"></div>
        </div>
    </div>

```
<script>
    let map1, map2;
    let currentZoom = 10;
    let currentCenter = [40.7128, -74.0060]; // NYC default
    
    // Initialize maps when Leaflet is ready
    function initializeMaps() {
        // Left panel - Satellite imagery
        map1 = L.map('satellite-view', {
            center: currentCenter,
            zoom: currentZoom,
            zoomControl: false
        });
        
        // ESRI World Imagery for left side
        L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
            attribution: '© Esri',
            maxZoom: 19
        }).addTo(map1);
        
        // Right panel - ESRI World Terrain Base (working terrain layer)
        map2 = L.map('elevation-view', {
            center: currentCenter,
            zoom: currentZoom,
            zoomControl: false
        });
        
        // Right panel - RGB-encoded height data (actual heightmap)
        map2 = L.map('elevation-view', {
            center: currentCenter,
            zoom: currentZoom,
            zoomControl: false
        });
        
        // AWS Terrarium - RGB encoded height data
        const heightLayer = L.tileLayer('https://s3.amazonaws.com/elevation-tiles-prod/terrarium/{z}/{x}/{y}.png', {
            attribution: 'Height data © AWS Terrarium',
            maxZoom: 15
        });
        
        heightLayer.on('tileerror', function() {
            // Fallback to Mapbox RGB height tiles
            console.log('AWS Terrarium failed, trying Mapbox RGB...');
            map2.removeLayer(heightLayer);
            L.tileLayer('https://api.mapbox.com/raster/v1/mapbox.terrain-rgb/{z}/{x}/{y}.pngraw?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4M29iazA2Z2gycXA4N2pmbDZmangifQ.-g_vE53SD2WrJ6tFX7QHmA', {
                attribution: 'Height data © Mapbox',
                maxZoom: 14
            }).addTo(map2);
        });
        
        heightLayer.on('tileload', function() {
            console.log('RGB height tiles loaded successfully');
        });
        
        heightLayer.addTo(map2);
        
        // Sync the maps
        let isSyncing = false;
        
        function syncMaps(sourceMap, targetMap) {
            if (isSyncing) return;
            isSyncing = true;
            
            const center = sourceMap.getCenter();
            const zoom = sourceMap.getZoom();
            
            targetMap.setView(center, zoom);
            
            setTimeout(() => {
                isSyncing = false;
            }, 100);
        }
        
        // Add sync event listeners
        map1.on('moveend', () => syncMaps(map1, map2));
        map1.on('zoomend', () => syncMaps(map1, map2));
        map2.on('moveend', () => syncMaps(map2, map1));
        map2.on('zoomend', () => syncMaps(map2, map1));
    }
    
    // Load Leaflet library
    function loadLeaflet() {
        // Add Leaflet CSS
        const leafletCSS = document.createElement('link');
        leafletCSS.rel = 'stylesheet';
        leafletCSS.href = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css';
        document.head.appendChild(leafletCSS);
        
        // Add Leaflet JS
        const leafletJS = document.createElement('script');
        leafletJS.src = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';
        leafletJS.onload = function() {
            initializeMaps();
        };
        leafletJS.onerror = function() {
            // Fallback if Leaflet fails to load
            document.getElementById('satellite-view').innerHTML = '<div style="display:flex;align-items:center;justify-content:center;height:100%;color:white;font-size:18px;">Network blocked - Leaflet library failed to load</div>';
            document.getElementById('elevation-view').innerHTML = '<div style="display:flex;align-items:center;justify-content:center;height:100%;color:white;font-size:18px;">Use local server or enable external resources</div>';
        };
        document.head.appendChild(leafletJS);
    }
    
    // Start loading
    loadLeaflet();
</script>
```

</body>
</html>